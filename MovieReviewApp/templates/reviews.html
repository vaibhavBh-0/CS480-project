{% extends 'base.html' %}

{% block head %}
<title>Task Master</title>
{% endblock %}

{% block body %}
<div class="content">
    <h1 style="text-align: center">Reviews</h1>
    {% if tasks|length < 1 %}
    <h4 style="text-align: center">There are no reviews. Create one below!</h4>
    {% else %}
    <table>
        <tr>
            <tr>
                <th>Movie</th>
                <th>Content</th>
                <th>Rating</th>
                <th>Added</th>
            </tr>
            <!-- <th>Actions</th> -->
        </tr>
        {% for task in tasks %}
            <tr>
                <td>{{ task.movie_id }}</td>
                <td>{{ task.content }}</td>
                <td>{{ task.rating }}</td>
                <td>{{ task.date_created.date() }}</td>
            </tr>
        {% endfor %}
    </table>
    {% endif %}

    <div class="form">
        <h2>Add a Review</h2>
        <form action="/reviews" method="POST">
            <label for="movie_id">Movie:</label><br>
            <select id="movie_id" name="movie_id" required>
                {% for movie in movies %}
                <option value="{{ movie.id }}">{{ movie.id }}</option>
                {% endfor %}
            </select><br><br>

            <label for="review_content">Review Content:</label><br>
            <textarea id="review_content" name="review_content" placeholder="Write your review here..." required></textarea><br><br>

            <label for="review_rating">Rating (1-10):</label><br>
            <input type="number" id="review_rating" name="review_rating" min="1" max="10" required><br><br>

            <input type="hidden" name="user_id" value="1"> <!-- Replace with actual user ID -->
            <button type="submit">Submit Review</button>
        </form>
    </div>
</div>
    
    <script>

        // Function to add a new cast form dynamically
        let castCount = 0;
        function addCastForm() {
            castCount++;
            const castContainer = document.getElementById("cast-container");
            
            const newCastForm = document.createElement("div");
            newCastForm.classList.add("cast-form");
            newCastForm.id = `cast-form-${castCount}`;

            newCastForm.innerHTML = `
                <label for="cast_name_${castCount}">Cast Name:</label> 
                <input type="text" id="cast_name_${castCount}" name="cast_name_${castCount}" required><br><br>
                
                <input type="radio" id="cast_role_actor_${castCount}" name="cast_role_${castCount}" value="Actor" required>
                <label for="cast_role_actor_${castCount}">Actor</label>

                <input type="radio" id="cast_role_director_${castCount}" name="cast_role_${castCount}" value="Director" required>
                <label for="cast_role_director_${castCount}">Director</label>

                <input type="radio" id="cast_role_writer_${castCount}" name="cast_role_${castCount}" value="Writer" required>
                <label for="cast_role_writer_${castCount}">Writer</label><br><br>
            `;

            castContainer.appendChild(newCastForm);
        }

        function formatToTwoDecimals() {
            // Get the input value
            const input = document.getElementById('numberInput').value;

            // Parse as a number and format to two decimal places
            const formatted = parseFloat(input).toFixed(2);

            // Display the formatted value
            document.getElementById('formattedNumber').textContent = formatted;
        }
    </script>
</div>
{% endblock %}